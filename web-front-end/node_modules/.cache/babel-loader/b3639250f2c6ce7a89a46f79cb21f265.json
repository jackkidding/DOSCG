{"ast":null,"code":"import _classCallCheck from \"/Users/fj02/DOSCG/web-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/fj02/DOSCG/web-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/**\r\n * Copyright 2019 Google LLC. All Rights Reserved.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/// <reference types=\"@types/googlemaps\" />\nvar Loader = /*#__PURE__*/function () {\n  function Loader(_ref) {\n    var apiKey = _ref.apiKey,\n        _ref$libraries = _ref.libraries,\n        libraries = _ref$libraries === void 0 ? [] : _ref$libraries,\n        channel = _ref.channel,\n        language = _ref.language,\n        clientId = _ref.clientId,\n        region = _ref.region,\n        version = _ref.version;\n\n    _classCallCheck(this, Loader);\n\n    this.CALLBACK = \"__google_maps_callback\";\n    this.URL = \"https://maps.googleapis.com/maps/api/js\";\n    this.callbacks = [];\n    this.done = false;\n    this.loading = false;\n    this.version = version;\n    this.apiKey = apiKey;\n    this.libraries = libraries;\n    this.channel = channel;\n    this.language = language;\n    this.clientId = clientId;\n    this.region = region;\n  }\n\n  _createClass(Loader, [{\n    key: \"createUrl\",\n    value: function createUrl() {\n      var url = this.URL;\n      url += \"?callback=\" + this.CALLBACK;\n\n      if (this.apiKey) {\n        url += \"&key=\" + this.apiKey;\n      }\n\n      if (this.libraries.length > 0) {\n        url += \"&libraries=\" + this.libraries.join(\",\");\n      }\n\n      if (this.clientId) {\n        url += \"&client=\" + this.clientId;\n      }\n\n      if (this.channel) {\n        url += \"&channel=\" + this.channel;\n      }\n\n      if (this.language) {\n        url += \"&language=\" + this.language;\n      }\n\n      if (this.region) {\n        url += \"&region=\" + this.region;\n      }\n\n      if (this.version) {\n        url += \"&v=\" + this.version;\n      }\n\n      return url;\n    }\n  }, {\n    key: \"load\",\n    value: function load() {\n      return this.loadPromise();\n    }\n  }, {\n    key: \"loadPromise\",\n    value: function loadPromise() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.loadCallback(function (err) {\n          if (!err) {\n            resolve();\n          } else {\n            reject(err);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"loadCallback\",\n    value: function loadCallback(fn) {\n      this.callbacks.push(fn);\n      this.execute();\n    }\n  }, {\n    key: \"setScript\",\n    value: function setScript() {\n      var url = this.createUrl();\n      var script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = url;\n      script.onerror = this.loadErrorCallback;\n      script.defer = true;\n      script.async = true;\n      document.head.appendChild(script);\n    }\n  }, {\n    key: \"loadErrorCallback\",\n    value: function loadErrorCallback(e) {\n      this.onerrorEvent = e;\n      this.callback();\n    }\n  }, {\n    key: \"setCallback\",\n    value: function setCallback() {\n      window[this.CALLBACK] = this.callback.bind(this);\n    }\n  }, {\n    key: \"callback\",\n    value: function callback() {\n      var _this2 = this;\n\n      this.done = true;\n      this.loading = false;\n      this.callbacks.forEach(function (cb) {\n        cb(_this2.onerrorEvent);\n      });\n      this.callbacks = [];\n    }\n  }, {\n    key: \"execute\",\n    value: function execute() {\n      if (this.done) {\n        this.callback();\n      } else {\n        if (this.loading) ;else {\n          this.loading = true;\n          this.setCallback();\n          this.setScript();\n        }\n      }\n    }\n  }]);\n\n  return Loader;\n}();\n\nexport { Loader };","map":{"version":3,"sources":["../src/loader.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/// <reference types=\"@types/googlemaps\" />\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nexport interface LoaderOptions {\n  apiKey: string;\n  version?: string;\n  libraries?: string[];\n  channel?: string;\n  language?: string;\n  clientId?: string;\n  region?: string;\n}\n\nexport class Loader {\n  public version: string;\n  public apiKey: string;\n  public libraries: string[];\n  public channel: string;\n  public language: string;\n  public clientId: string;\n  public region: string;\n\n  private CALLBACK = \"__google_maps_callback\";\n  private URL = \"https://maps.googleapis.com/maps/api/js\";\n  private callbacks: Array<(e: Event) => any> = [];\n  private done = false;\n  private loading = false;\n  private onerrorEvent: Event;\n\n  constructor({\n    apiKey,\n    libraries = [],\n    channel,\n    language,\n    clientId,\n    region,\n    version\n  }: LoaderOptions) {\n    this.version = version;\n    this.apiKey = apiKey;\n    this.libraries = libraries;\n    this.channel = channel;\n    this.language = language;\n    this.clientId = clientId;\n    this.region = region;\n  }\n\n  public createUrl(): string {\n    let url = this.URL;\n\n    url += \"?callback=\" + this.CALLBACK;\n\n    if (this.apiKey) {\n      url += \"&key=\" + this.apiKey;\n    }\n\n    if (this.libraries.length > 0) {\n      url += \"&libraries=\" + this.libraries.join(\",\");\n    }\n\n    if (this.clientId) {\n      url += \"&client=\" + this.clientId;\n    }\n\n    if (this.channel) {\n      url += \"&channel=\" + this.channel;\n    }\n\n    if (this.language) {\n      url += \"&language=\" + this.language;\n    }\n\n    if (this.region) {\n      url += \"&region=\" + this.region;\n    }\n\n    if (this.version) {\n      url += \"&v=\" + this.version;\n    }\n\n    return url;\n  }\n\n  public load(): Promise<void> {\n    return this.loadPromise();\n  }\n\n  public loadPromise(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.loadCallback((err: Event) => {\n        if (!err) {\n          resolve();\n        } else {\n          reject(err);\n        }\n      });\n    });\n  }\n\n  public loadCallback(fn: (e: Event) => any): void {\n    this.callbacks.push(fn);\n    this.execute();\n  }\n\n  private setScript(): void {\n    const url = this.createUrl();\n    const script = document.createElement(\"script\");\n\n    script.type = \"text/javascript\";\n    script.src = url;\n    script.onerror = this.loadErrorCallback;\n    script.defer = true;\n    script.async = true;\n    document.head.appendChild(script);\n  }\n\n  private loadErrorCallback(e: Event): void {\n    this.onerrorEvent = e;\n    this.callback();\n  }\n\n  private setCallback(): void {\n    (window as any)[this.CALLBACK] = this.callback.bind(this);\n  }\n\n  private callback(): void {\n    this.done = true;\n    this.loading = false;\n\n    this.callbacks.forEach(cb => {\n      cb(this.onerrorEvent);\n    });\n\n    this.callbacks = [];\n  }\n\n  private execute(): void {\n    if (this.done) {\n      this.callback();\n    } else {\n      if (this.loading) {\n        // do nothing but wait\n      } else {\n        this.loading = true;\n        this.setCallback();\n        this.setScript();\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}